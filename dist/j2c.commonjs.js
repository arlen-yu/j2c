'use strict';

var emptyObject = {};
var type = emptyObject.toString;
var ARRAY =  type.call([]);
var NUMBER = type.call(0);
var OBJECT = type.call(emptyObject);
var STRING = type.call('');
var FUNCTION = type.call(type);
var own =  emptyObject.hasOwnProperty;
var freeze = Object.freeze || function(o) {return o};


function defaults(target, source) {
  for (var k in source) if (own.call(source, k)) {
    if (k.indexOf('$') && !(k in target)) target[k] = source[k];
  }
  return target
}

function cartesian(a,b) {
  var res = [], i, j;
  for (j in b) if(own.call(b, j))
    for (i in a) if(own.call(a, i))
      res.push(a[i] + b[j]);
  return res
}

// "Tokenizes" the selectors into parts relevant for the next function.
// Strings and comments are matched, but ignored afterwards.
// This is not a full tokenizers. It only recognizes comas, parentheses,
// strings and comments.
// regexp generated by scripts/regexps.js then trimmed by hand
var selectorTokenizer = /[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;


/**
 * This will split a coma-separated selector list into individual selectors,
 * ignoring comas in strings, comments and in :pseudo-selectors(parameter, lists).
 *
 * @param {string} selector
 * @return {string[]}
 */

function splitSelector(selector) {
  var indices = [], res = [], inParen = 0, o;
  /*eslint-disable no-cond-assign*/
  while (o = selectorTokenizer.exec(selector)) {
  /*eslint-enable no-cond-assign*/
    switch (o[0]) {
    case '(': inParen++; break
    case ')': inParen--; break
    case ',': if (inParen) break; indices.push(o.index);
    }
  }
  for (o = indices.length; o--;){
    res.unshift(selector.slice(indices[o] + 1));
    selector = selector.slice(0, indices[o]);
  }
  res.unshift(selector);
  return res
}

// Like the `selectorTokenizer`, but for the `&` operator
var ampersandTokenizer = /&|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;

function ampersand (selector, parents) {
  var indices = [], split = [], res, o;
  /*eslint-disable no-cond-assign*/
  while (o = ampersandTokenizer.exec(selector)) {
  /*eslint-enable no-cond-assign*/
    if (o[0] == '&') indices.push(o.index);
  }
  for (o = indices.length; o--;){
    split.unshift(selector.slice(indices[o] + 1));
    selector = selector.slice(0, indices[o]);
  }
  split.unshift(selector);
  if (split.length === 1) split.unshift('');
  res = [split[0]];
  for (o = 1; o < split.length; o++) {
    res = cartesian(res, cartesian(parents, [split[o]]));
  }
  return res.join(',')
}

function flatIter (f) {
  return function iter(arg) {
    if (type.call(arg) === ARRAY) for (var i= 0 ; i < arg.length; i ++) iter(arg[i]);
    else f(arg);
  }
}

var chars = '';
function randChars(n) {
  while(chars.length < n) chars += Math.floor(Math.random() * 0x100000000).toString(36);
  var res = '_' + chars.slice(0, n);
  chars = chars.slice(n);
  return res
}

function decamelize(match) {
  return '-' + match.toLowerCase()
}

/**
 * Handles the property:value; pairs.
 *
 * @param {object} state - holds the localizer- and walker-related methods
 *                         and state
 * @param {object} emit - the contextual emitters to the final buffer
 * @param {string} prefix - the current property or a prefix in case of nested
 *                          sub-properties.
 * @param {array|object|string} o - the declarations.
 * @param {boolean} local - are we in @local or in @global scope.
 */

function declarations(state, emit, prefix, o, local) {
  var k, v, kk;
  if (o==null) return

  switch ( type.call(o = o.valueOf()) ) {
  case ARRAY:
    for (k = 0; k < o.length; k++)

      declarations(state, emit, prefix, o[k], local);

    break
  case OBJECT:
    // prefix is falsy iif it is the empty string, which means we're at the root
    // of the declarations list.
    prefix = (prefix && prefix + '-');
    for (k in o) if (own.call(o, k)){
      v = o[k];
      if (/\$/.test(k)) {
        for (kk in (k = k.split('$'))) if (own.call(k, kk)) {

          declarations(state, emit, prefix + k[kk], v, local);

        }
      } else {

        declarations(state, emit, prefix + k, v, local);

      }
    }
    break
  default:
    // prefix is falsy when it is "", which means that we're
    // at the top level.
    // `o` is then treated as a `property:value` pair, or a
    // semi-colon-separated list thereof.
    // Otherwise, `prefix` is the property name, and
    // `o` is the value.

    // restore the dashes
    k = prefix.replace(/_/g, '-').replace(/[A-Z]/g, decamelize);

    if (local && (k == 'animation-name' || k == 'animation' || k == 'list-style')) {
      // no need to tokenize here a plain `.split(',')` has all bases covered.
      // We may 'localize' a comment, but it's not a big deal.
      o = o.split(',').map(function (o) {

        return o.replace(/^\s*(?:(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*))/, state.localizeReplacer)

      }).join(',');
    }

    if(k) emit.decl(k, o);
    else emit.raw(o);

  }
}

/**
 * Handles a single at-rules
 *
 * @param {object} state - holds the localizer- and walker-related methods
 *                         and state
 * @param {object} emit - the contextual emitters to the final buffer
 * @param {array} k - The parsed at-rule, including the parameters,
 *                    if takes both parameters and a block.
 *                    k == [match, fullAtRule, atRuleType, params?]
 *                    So in `@-webkit-keyframes foo`, we have
 *                     - match = "@-webkit-keyframes foo"
 *                     - fullAtRule = "@-webkit-keyframes"
 *                     - atRuleType = "keyframes"
 *                     - params = "foo"
 * @param {string|string[]|object|object[]} v - Either parameters for
 *                                              block-less rules or
 *                                              their block
 *                                              for the others.
 * @param {string} prefix - the current selector or the selector prefix
 *                          in case of nested rules
 * @param {boolean} local - are we in @local or in @global scope?
 * @param {string} nestingDepth - are we nested in an at-rule or a selector?
 */

function atRules(state, emit, k, v, prefix, local, nestingDepth) {

  // First iterate over user-provided at-rules and return if one of them corresponds to the current one
  for (var i = 0; i < state.atruleHandlers.length; i++) {

    if (state.atruleHandlers[i](state, emit, k, v, prefix, local, nestingDepth)) return

  }

  // using `/^global$/.test(k[2])` rather that 'global' == k[2] gzips
  // slightly better thanks to the regexps tests further down.
  // It is slightly less efficient but this isn't a critical path.

  if (!k[3] && /^global$/.test(k[2])) {

    rules(state, emit, prefix, v, 0, nestingDepth);


  } else if (!k[3] && /^local$/.test(k[2])) {

    rules(state, emit, prefix, v, 1, nestingDepth);


  } else if (k[3] && /^adopt$/.test(k[2])) {

    if (!local || nestingDepth) return emit.err('@adopt global or nested: ' + k[0])

    if (!/^\.?[_A-Za-z][-\w]*$/.test(k[3])) return emit.err('bad adopter ' + JSON.stringify(k[3]) + ' in ' + k[0])

    i = [];
    flatIter(function(adoptee, asString) {

      if(adoptee == null || !/^\.?[_A-Za-z][-\w]*(?:\s+\.?[_A-Za-z][-\w]*)*$/.test(asString = adoptee + '')) emit.err('bad adoptee '+ JSON.stringify(adoptee) + ' in ' + k[0]);

      else i.push(asString.replace(/\./g, ''));

    })(v);

    // we may end up with duplicate classes but AFAIK it has no consequences on specificity.
    if (i.length) {
      state.localize(k[3] = k[3].replace(/\./g, ''));
      state.names[k[3]] += (' ' + i.join(' '));
    }


  } else if (!k[3] && /^(?:namespace|import|charset)$/.test(k[2])) {
    flatIter(function(v) {

      emit.atrule(k[1], k[2], v);

    })(v);


  } else if (!k[3] && /^(?:font-face|viewport)$/.test(k[2])) {
    flatIter(function(v) {

      emit.atrule(k[1], k[2], k[3], 'decl');

      declarations(state, emit, '', v, local);

      emit._atrule();

    })(v);

  } else if (k[3] && /^(?:media|supports|page|keyframes)$/.test(k[2])) {

    if (local && 'keyframes' == k[2]) {
      k[3] = k[3].replace(
        // generated by script/regexps.js
        /(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*)/,
        state.localizeReplacer
      );
    }

    if ('page' == k[2]) {

      emit.atrule(k[1], k[2], k[3], 'decl');

      declarations(state, emit, '', v, local);

    } else {

      emit.atrule(k[1], k[2], k[3], 'rule');

      rules(
        state, emit,
        'keyframes' == k[2] ? '' : prefix,
        v, local, nestingDepth + 1
      );

    }

    emit._atrule();

  } else {

    emit.err('Unsupported at-rule: ' + k[0]);

  }
}

/**
 * Add rulesets and other CSS tree to the sheet.
 *
 * @param {object} state - holds the localizer- and walker-related methods
 *                         and state
 * @param {object} emit - the contextual emitters to the final buffer
 * @param {string} prefix - the current selector or a prefix in case of nested rules
 * @param {array|string|object} tree - a source object or sub-object.
 * @param {string} nestingDepth - are we nested in an at-rule?
 * @param {boolean} local - are we in @local or in @global scope?
 */
function rules(state, emit, prefix, tree, local, nestingDepth) {
  var k, v, inDeclaration, kk;

  switch (type.call(tree)) {

  case OBJECT:
    for (k in tree) if (own.call(tree, k)) {
      v = tree[k];

      if (prefix.length > 0 && /^[-\w$]+$/.test(k)) {
        if (!inDeclaration) {
          inDeclaration = 1;

          emit.rule(prefix);

        }
        if (/\$/.test(k)) {
          for (kk in (k = k.split('$'))) if (own.call(k, kk)) {

            declarations(state, emit, k[kk], v, local);

          }
        } else {

          declarations(state, emit, k, v, local);

        }

      } else if (/^@/.test(k)) {
        // Handle At-rules
        inDeclaration = 0;

        atRules(state, emit,
          /^(.(?:-[\w]+-)?([_A-Za-z][-\w]*))\b\s*(.*?)\s*$/.exec(k) || [k,'@','',''],
          v, prefix, local, nestingDepth
        );

      } else {
        // selector or nested sub-selectors
        inDeclaration = 0;

        rules(
          state, emit,
          // build the selector `prefix` for the next iteration.
          // ugly and full of redundant bits but so far the fastest/shortest.gz
          /*0 if*/(prefix.length > 0 && (/,/.test(prefix) || /,/.test(k))) ?

            /*0 then*/ (kk = splitSelector(prefix), splitSelector(
              local ?

                k.replace(
                  /("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,
                  state.localizeReplacer
                ) :

                k
            ).map(function (k) {
              return /&/.test(k) ? ampersand(k, kk) : kk.map(function(kk) {
                return kk + k
              }).join(',')
            }).join(',')) :

            /*0 else*/ /*1 if*/ /&/.test(k) ?

              /*1 then*/ ampersand(
                local ?

                  k.replace(
                    /("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,
                    state.localizeReplacer
                  ) :

                  k,
                [prefix]
              ) :

              /*1 else*/ prefix + (
                local ?

                  k.replace(
                    /("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,
                    state.localizeReplacer
                  ) :

                  k
                ),
           v, local, nestingDepth + 1
        );

      }
    }

    break

  case ARRAY:
    for (k = 0; k < tree.length; k++){

      rules(state, emit, prefix, tree[k], local, nestingDepth);

    }
    break

  case STRING:
    // CSS hacks or ouptut of `j2c.inline`.

    if (prefix.length) emit.rule(prefix);

    emit.raw(tree);

  }
}

// This is the first entry in the filters array, which is
// actually the last step of the compiler. It inserts
// closing braces to close normal (non at-) rules (those
// that start with a selector). Doing it earlier is
// impossible without passing state around in unrelated code
// or ending up with duplicated selectors when the source tree
// contains arrays.
// There's no `_rule` handler, because the core compiler never
// calls it.
function closeSelectors(next, inline) {
  var lastSelector;
  return inline ? next : {
    init: function(){lastSelector = 0; next.init();},
    done: function (raw) {
      if (lastSelector) {next._rule(); lastSelector = 0;}
      return next.done(raw)
    },
    atrule: function (rule, kind, param, takesBlock) {
      if (lastSelector) {next._rule(); lastSelector = 0;}
      next.atrule(rule, kind, param, takesBlock);
    },
    _atrule: function (rule) {
      if (lastSelector) {next._rule(); lastSelector = 0;}
      next._atrule(rule);
    },
    rule: function (selector) {
      if (selector !== lastSelector){
        if (lastSelector) next._rule();
        next.rule(selector);
        lastSelector = selector;
      }
    }
  }
}

function global(x) {
  return ':global(' + x + ')'
}

function kv (k, v, o) {
  o = {};
  o[k] = v;
  return o
}

function at (rule, params, block) {
  if (
    arguments.length < 3
  ) {
    // inner curry!
    var _at = at.bind.apply(at, [null].concat([].slice.call(arguments,0)));
    // So that it can be used as a key in an ES6 object literal.
    _at.toString = function(){return '@' + rule + ' ' + params};
    return _at
  }
  else return kv('@' + rule +' ' + params, block)
}

function J2c(options) {
  options = options || {};
  // the buffer that accumulates the output. Initialized in `$sink.init()`
  var buf, err;

  // the default sink.
  var _backend = [{
    init: function(){buf=[], err=[];},
    done: function (raw) {
      if (err.length != 0) throw new Error('j2c error(s): ' + JSON.stringify(err,null,2) + 'in context:\n' + buf.join(''))
      return raw ? buf : buf.join('')
    },
    err: function(msg) {
      err.push(msg);
      buf.push('/* +++ ERROR +++ ' + msg + ' */\n');
    },
    raw: function(str) {buf.push(str, _instance.endline);},
    atrule: function (rule, kind, param, takesBlock) {
      buf.push(rule, param && ' ', param, takesBlock ? ' {' : ';', _instance.endline);
    },
    // close atrule
    _atrule: function () {buf.push('}', _instance.endline);},
    rule: function (selector) {buf.push(selector, ' {', _instance.endline);},
    // close rule
    _rule: function () {buf.push('}', _instance.endline);},
    decl: function (prop, value) {buf.push(prop, ':', value, ';', _instance.endline);}
  }];

  // holds the `_filter` and `atrule` handlers
  var _filters = [closeSelectors];
  var _atruleHandlers = [];

  // the public API (see the main docs)
  var _instance = {
    at: at,
    global: global,
    kv: kv,
    names: {},
    endline: '\n',
    suffix: randChars(7),
    plugins: [],
    sheet: function(tree) {
      _backend[0].init();
      rules(
        _walkers[0],
        _backend[0],
        '', // prefix
        tree,
        1,  // local, by default
        0   // nesting depth
      );

      return _backend[0].done()
    },
    inline: function (tree, options) {
      _backend[1].init();
      declarations(
        _walkers[1],
        _backend[1],
        '', // prefix
        tree,
        !(options && options.global)   // local, by default
      );
      return _backend[1].done()
    }
  };

  // The `state` (for the core functions) / `walker` (for the plugins) tables.
  var _walkers = [
    // for j2c.sheet
    {
      // helpers for locaizing class and animation names
      localizeReplacer: _localizeReplacer, // second argument to String.prototype.replace
      localize: _localize,                 // mangles local names
      names: _instance.names,              // local => mangled mapping
      atruleHandlers: _atruleHandlers,            // extra at-rules
      // The core walker methods, to be provided to plugins
      atrule: atRules,
      decl: declarations,
      rule: rules
    },
    // likewise, for j2c.inline (idem with `$a`, `a` and `s` removed)
    {
      localizeReplacer: _localizeReplacer,
      localize: _localize,
      names: _instance.names,
      decl: declarations
    }
  ];

  /**
   * Returns a localized version of a given name.
   * Registers the pair in `instnace.name` if needed.
   *
   * @param {string} name - the name to localize
   * @return {string} - the localized version
   */
  function _localize(name) {
    if (!_instance.names[name]) _instance.names[name] = name + _instance.suffix;
    return _instance.names[name].match(/^\S+/)
  }

  /**
   * Used as second argument for str.replace(localizeRegex, replacer)
   * `ignore`, `global` and `(dot, name)` are mutually exclusive
   *
   * @param {string} match - the whole match (ignored)
   * @param {string|null} ignore - a comment or a string literal
   * @param {string|null} global - a global name
   * @param {string|null} dot - either '.' for a local class name or the empty string otherwise
   * @param {string|null} name - the name to localize
   * @return {string}
   */
  function _localizeReplacer(match, ignore, global$$1, dot, name) {
    return ignore || global$$1 || dot + _localize(name)
  }

  // handler options
  if (type.call(options.plugins) === ARRAY) {
    flatIter(function(plugin) {
      _instance.plugins.push(plugin);
      if (type.call(plugin) === FUNCTION) plugin = plugin(_instance);
      if (!plugin) return

      if (type.call(plugin.filter) === FUNCTION) _filters.push(plugin.filter);
      if (type.call(plugin.atrule) === FUNCTION) _atruleHandlers.push(plugin.atrule);
      if (type.call(plugin.sink) === FUNCTION) _backend = plugin.sink();
    })(options.plugins);
  }
  if (type.call(options.names) === OBJECT) _instance.names = options.names;
  if (type.call(options.suffix) === STRING) _instance.suffix = options.suffix;
  if (type.call(options.suffix) === NUMBER) _instance.suffix = randChars(options.suffix);
  if (type.call(options.endline) === STRING) _instance.endline = options.endine;

  _backend[1] = _backend[1] || {
    init: _backend[0].init,
    done: _backend[0].done,
    raw: _backend[0].raw,
    err: _backend[0].err,
    decl: _backend[0].decl
  };

  // finalize the backend by merging in the filters
  for(var i = 0; i < 2; i++){ // 0 for j2c.sheet, 1 for j2c.inline
    for (var j = _filters.length; j--;) {
      _backend[i] = freeze(
        defaults(
          _filters[j](_backend[i], !!i),
          _backend[i]
        )
      );
    }
  }

  freeze(_instance);
  return _instance
}

module.exports = J2c;

//data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9Vc2Vycy9weWd5L2Rldi9qMmMvajJjL3NyYy9oZWxwZXJzLmpzIiwiL1VzZXJzL3B5Z3kvZGV2L2oyYy9qMmMvc3JjL2RlY2xhcmF0aW9ucy5qcyIsIi9Vc2Vycy9weWd5L2Rldi9qMmMvajJjL3NyYy9hdC1ydWxlcy5qcyIsIi9Vc2Vycy9weWd5L2Rldi9qMmMvajJjL3NyYy9ydWxlcy5qcyIsIi9Vc2Vycy9weWd5L2Rldi9qMmMvajJjL3NyYy9leHRyYXMuanMiLCIvVXNlcnMvcHlneS9kZXYvajJjL2oyYy9zcmMvbWFpbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXJcbiAgZW1wdHlPYmplY3QgPSB7fSxcbiAgdHlwZSA9IGVtcHR5T2JqZWN0LnRvU3RyaW5nLFxuICBBUlJBWSA9ICB0eXBlLmNhbGwoW10pLFxuICBOVU1CRVIgPSB0eXBlLmNhbGwoMCksXG4gIE9CSkVDVCA9IHR5cGUuY2FsbChlbXB0eU9iamVjdCksXG4gIFNUUklORyA9IHR5cGUuY2FsbCgnJyksXG4gIEZVTkNUSU9OID0gdHlwZS5jYWxsKHR5cGUpLFxuICBvd24gPSAgZW1wdHlPYmplY3QuaGFzT3duUHJvcGVydHksXG4gIGZyZWV6ZSA9IE9iamVjdC5mcmVlemUgfHwgZnVuY3Rpb24obykge3JldHVybiBvfVxuXG5cbmZ1bmN0aW9uIGRlZmF1bHRzKHRhcmdldCwgc291cmNlKSB7XG4gIGZvciAodmFyIGsgaW4gc291cmNlKSBpZiAob3duLmNhbGwoc291cmNlLCBrKSkge1xuICAgIGlmIChrLmluZGV4T2YoJyQnKSAmJiAhKGsgaW4gdGFyZ2V0KSkgdGFyZ2V0W2tdID0gc291cmNlW2tdXG4gIH1cbiAgcmV0dXJuIHRhcmdldFxufVxuXG5mdW5jdGlvbiBjYXJ0ZXNpYW4oYSxiKSB7XG4gIHZhciByZXMgPSBbXSwgaSwgalxuICBmb3IgKGogaW4gYikgaWYob3duLmNhbGwoYiwgaikpXG4gICAgZm9yIChpIGluIGEpIGlmKG93bi5jYWxsKGEsIGkpKVxuICAgICAgcmVzLnB1c2goYVtpXSArIGJbal0pXG4gIHJldHVybiByZXNcbn1cblxuLy8gXCJUb2tlbml6ZXNcIiB0aGUgc2VsZWN0b3JzIGludG8gcGFydHMgcmVsZXZhbnQgZm9yIHRoZSBuZXh0IGZ1bmN0aW9uLlxuLy8gU3RyaW5ncyBhbmQgY29tbWVudHMgYXJlIG1hdGNoZWQsIGJ1dCBpZ25vcmVkIGFmdGVyd2FyZHMuXG4vLyBUaGlzIGlzIG5vdCBhIGZ1bGwgdG9rZW5pemVycy4gSXQgb25seSByZWNvZ25pemVzIGNvbWFzLCBwYXJlbnRoZXNlcyxcbi8vIHN0cmluZ3MgYW5kIGNvbW1lbnRzLlxuLy8gcmVnZXhwIGdlbmVyYXRlZCBieSBzY3JpcHRzL3JlZ2V4cHMuanMgdGhlbiB0cmltbWVkIGJ5IGhhbmRcbnZhciBzZWxlY3RvclRva2VuaXplciA9IC9bKCksXXxcIig/OlxcXFwufFteXCJcXG5dKSpcInwnKD86XFxcXC58W14nXFxuXSkqJ3xcXC9cXCpbXFxzXFxTXSo/XFwqXFwvL2dcblxuXG4vKipcbiAqIFRoaXMgd2lsbCBzcGxpdCBhIGNvbWEtc2VwYXJhdGVkIHNlbGVjdG9yIGxpc3QgaW50byBpbmRpdmlkdWFsIHNlbGVjdG9ycyxcbiAqIGlnbm9yaW5nIGNvbWFzIGluIHN0cmluZ3MsIGNvbW1lbnRzIGFuZCBpbiA6cHNldWRvLXNlbGVjdG9ycyhwYXJhbWV0ZXIsIGxpc3RzKS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gc2VsZWN0b3JcbiAqIEByZXR1cm4ge3N0cmluZ1tdfVxuICovXG5cbmZ1bmN0aW9uIHNwbGl0U2VsZWN0b3Ioc2VsZWN0b3IpIHtcbiAgdmFyIGluZGljZXMgPSBbXSwgcmVzID0gW10sIGluUGFyZW4gPSAwLCBvXG4gIC8qZXNsaW50LWRpc2FibGUgbm8tY29uZC1hc3NpZ24qL1xuICB3aGlsZSAobyA9IHNlbGVjdG9yVG9rZW5pemVyLmV4ZWMoc2VsZWN0b3IpKSB7XG4gIC8qZXNsaW50LWVuYWJsZSBuby1jb25kLWFzc2lnbiovXG4gICAgc3dpdGNoIChvWzBdKSB7XG4gICAgY2FzZSAnKCc6IGluUGFyZW4rKzsgYnJlYWtcbiAgICBjYXNlICcpJzogaW5QYXJlbi0tOyBicmVha1xuICAgIGNhc2UgJywnOiBpZiAoaW5QYXJlbikgYnJlYWs7IGluZGljZXMucHVzaChvLmluZGV4KVxuICAgIH1cbiAgfVxuICBmb3IgKG8gPSBpbmRpY2VzLmxlbmd0aDsgby0tOyl7XG4gICAgcmVzLnVuc2hpZnQoc2VsZWN0b3Iuc2xpY2UoaW5kaWNlc1tvXSArIDEpKVxuICAgIHNlbGVjdG9yID0gc2VsZWN0b3Iuc2xpY2UoMCwgaW5kaWNlc1tvXSlcbiAgfVxuICByZXMudW5zaGlmdChzZWxlY3RvcilcbiAgcmV0dXJuIHJlc1xufVxuXG4vLyBMaWtlIHRoZSBgc2VsZWN0b3JUb2tlbml6ZXJgLCBidXQgZm9yIHRoZSBgJmAgb3BlcmF0b3JcbnZhciBhbXBlcnNhbmRUb2tlbml6ZXIgPSAvJnxcIig/OlxcXFwufFteXCJcXG5dKSpcInwnKD86XFxcXC58W14nXFxuXSkqJ3xcXC9cXCpbXFxzXFxTXSo/XFwqXFwvL2dcblxuZnVuY3Rpb24gYW1wZXJzYW5kIChzZWxlY3RvciwgcGFyZW50cykge1xuICB2YXIgaW5kaWNlcyA9IFtdLCBzcGxpdCA9IFtdLCByZXMsIG9cbiAgLyplc2xpbnQtZGlzYWJsZSBuby1jb25kLWFzc2lnbiovXG4gIHdoaWxlIChvID0gYW1wZXJzYW5kVG9rZW5pemVyLmV4ZWMoc2VsZWN0b3IpKSB7XG4gIC8qZXNsaW50LWVuYWJsZSBuby1jb25kLWFzc2lnbiovXG4gICAgaWYgKG9bMF0gPT0gJyYnKSBpbmRpY2VzLnB1c2goby5pbmRleClcbiAgfVxuICBmb3IgKG8gPSBpbmRpY2VzLmxlbmd0aDsgby0tOyl7XG4gICAgc3BsaXQudW5zaGlmdChzZWxlY3Rvci5zbGljZShpbmRpY2VzW29dICsgMSkpXG4gICAgc2VsZWN0b3IgPSBzZWxlY3Rvci5zbGljZSgwLCBpbmRpY2VzW29dKVxuICB9XG4gIHNwbGl0LnVuc2hpZnQoc2VsZWN0b3IpXG4gIGlmIChzcGxpdC5sZW5ndGggPT09IDEpIHNwbGl0LnVuc2hpZnQoJycpXG4gIHJlcyA9IFtzcGxpdFswXV1cbiAgZm9yIChvID0gMTsgbyA8IHNwbGl0Lmxlbmd0aDsgbysrKSB7XG4gICAgcmVzID0gY2FydGVzaWFuKHJlcywgY2FydGVzaWFuKHBhcmVudHMsIFtzcGxpdFtvXV0pKVxuICB9XG4gIHJldHVybiByZXMuam9pbignLCcpXG59XG5cbmZ1bmN0aW9uIGZsYXRJdGVyIChmKSB7XG4gIHJldHVybiBmdW5jdGlvbiBpdGVyKGFyZykge1xuICAgIGlmICh0eXBlLmNhbGwoYXJnKSA9PT0gQVJSQVkpIGZvciAodmFyIGk9IDAgOyBpIDwgYXJnLmxlbmd0aDsgaSArKykgaXRlcihhcmdbaV0pXG4gICAgZWxzZSBmKGFyZylcbiAgfVxufVxuXG52YXIgY2hhcnMgPSAnJ1xuZnVuY3Rpb24gcmFuZENoYXJzKG4pIHtcbiAgd2hpbGUoY2hhcnMubGVuZ3RoIDwgbikgY2hhcnMgKz0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMHgxMDAwMDAwMDApLnRvU3RyaW5nKDM2KVxuICB2YXIgcmVzID0gJ18nICsgY2hhcnMuc2xpY2UoMCwgbilcbiAgY2hhcnMgPSBjaGFycy5zbGljZShuKVxuICByZXR1cm4gcmVzXG59XG5cbmV4cG9ydCB7XG4gIEFSUkFZLCBGVU5DVElPTiwgTlVNQkVSLCBPQkpFQ1QsIFNUUklORyxcbiAgYW1wZXJzYW5kLCBjYXJ0ZXNpYW4sIGRlZmF1bHRzLFxuICBmbGF0SXRlciwgZnJlZXplLCBvd24sXG4gIHJhbmRDaGFycywgc3BsaXRTZWxlY3RvciwgdHlwZVxufSIsImltcG9ydCB7b3duLCB0eXBlLCBBUlJBWSwgT0JKRUNUfSBmcm9tICcuL2hlbHBlcnMnXG5cbmZ1bmN0aW9uIGRlY2FtZWxpemUobWF0Y2gpIHtcbiAgcmV0dXJuICctJyArIG1hdGNoLnRvTG93ZXJDYXNlKClcbn1cblxuLyoqXG4gKiBIYW5kbGVzIHRoZSBwcm9wZXJ0eTp2YWx1ZTsgcGFpcnMuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IHN0YXRlIC0gaG9sZHMgdGhlIGxvY2FsaXplci0gYW5kIHdhbGtlci1yZWxhdGVkIG1ldGhvZHNcbiAqICAgICAgICAgICAgICAgICAgICAgICAgIGFuZCBzdGF0ZVxuICogQHBhcmFtIHtvYmplY3R9IGVtaXQgLSB0aGUgY29udGV4dHVhbCBlbWl0dGVycyB0byB0aGUgZmluYWwgYnVmZmVyXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJlZml4IC0gdGhlIGN1cnJlbnQgcHJvcGVydHkgb3IgYSBwcmVmaXggaW4gY2FzZSBvZiBuZXN0ZWRcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBzdWItcHJvcGVydGllcy5cbiAqIEBwYXJhbSB7YXJyYXl8b2JqZWN0fHN0cmluZ30gbyAtIHRoZSBkZWNsYXJhdGlvbnMuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGxvY2FsIC0gYXJlIHdlIGluIEBsb2NhbCBvciBpbiBAZ2xvYmFsIHNjb3BlLlxuICovXG5cbmV4cG9ydCBmdW5jdGlvbiBkZWNsYXJhdGlvbnMoc3RhdGUsIGVtaXQsIHByZWZpeCwgbywgbG9jYWwpIHtcbiAgdmFyIGssIHYsIGtrXG4gIGlmIChvPT1udWxsKSByZXR1cm5cblxuICBzd2l0Y2ggKCB0eXBlLmNhbGwobyA9IG8udmFsdWVPZigpKSApIHtcbiAgY2FzZSBBUlJBWTpcbiAgICBmb3IgKGsgPSAwOyBrIDwgby5sZW5ndGg7IGsrKylcblxuICAgICAgZGVjbGFyYXRpb25zKHN0YXRlLCBlbWl0LCBwcmVmaXgsIG9ba10sIGxvY2FsKVxuXG4gICAgYnJlYWtcbiAgY2FzZSBPQkpFQ1Q6XG4gICAgLy8gcHJlZml4IGlzIGZhbHN5IGlpZiBpdCBpcyB0aGUgZW1wdHkgc3RyaW5nLCB3aGljaCBtZWFucyB3ZSdyZSBhdCB0aGUgcm9vdFxuICAgIC8vIG9mIHRoZSBkZWNsYXJhdGlvbnMgbGlzdC5cbiAgICBwcmVmaXggPSAocHJlZml4ICYmIHByZWZpeCArICctJylcbiAgICBmb3IgKGsgaW4gbykgaWYgKG93bi5jYWxsKG8sIGspKXtcbiAgICAgIHYgPSBvW2tdXG4gICAgICBpZiAoL1xcJC8udGVzdChrKSkge1xuICAgICAgICBmb3IgKGtrIGluIChrID0gay5zcGxpdCgnJCcpKSkgaWYgKG93bi5jYWxsKGssIGtrKSkge1xuXG4gICAgICAgICAgZGVjbGFyYXRpb25zKHN0YXRlLCBlbWl0LCBwcmVmaXggKyBrW2trXSwgdiwgbG9jYWwpXG5cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcblxuICAgICAgICBkZWNsYXJhdGlvbnMoc3RhdGUsIGVtaXQsIHByZWZpeCArIGssIHYsIGxvY2FsKVxuXG4gICAgICB9XG4gICAgfVxuICAgIGJyZWFrXG4gIGRlZmF1bHQ6XG4gICAgLy8gcHJlZml4IGlzIGZhbHN5IHdoZW4gaXQgaXMgXCJcIiwgd2hpY2ggbWVhbnMgdGhhdCB3ZSdyZVxuICAgIC8vIGF0IHRoZSB0b3AgbGV2ZWwuXG4gICAgLy8gYG9gIGlzIHRoZW4gdHJlYXRlZCBhcyBhIGBwcm9wZXJ0eTp2YWx1ZWAgcGFpciwgb3IgYVxuICAgIC8vIHNlbWktY29sb24tc2VwYXJhdGVkIGxpc3QgdGhlcmVvZi5cbiAgICAvLyBPdGhlcndpc2UsIGBwcmVmaXhgIGlzIHRoZSBwcm9wZXJ0eSBuYW1lLCBhbmRcbiAgICAvLyBgb2AgaXMgdGhlIHZhbHVlLlxuXG4gICAgLy8gcmVzdG9yZSB0aGUgZGFzaGVzXG4gICAgayA9IHByZWZpeC5yZXBsYWNlKC9fL2csICctJykucmVwbGFjZSgvW0EtWl0vZywgZGVjYW1lbGl6ZSlcblxuICAgIGlmIChsb2NhbCAmJiAoayA9PSAnYW5pbWF0aW9uLW5hbWUnIHx8IGsgPT0gJ2FuaW1hdGlvbicgfHwgayA9PSAnbGlzdC1zdHlsZScpKSB7XG4gICAgICAvLyBubyBuZWVkIHRvIHRva2VuaXplIGhlcmUgYSBwbGFpbiBgLnNwbGl0KCcsJylgIGhhcyBhbGwgYmFzZXMgY292ZXJlZC5cbiAgICAgIC8vIFdlIG1heSAnbG9jYWxpemUnIGEgY29tbWVudCwgYnV0IGl0J3Mgbm90IGEgYmlnIGRlYWwuXG4gICAgICBvID0gby5zcGxpdCgnLCcpLm1hcChmdW5jdGlvbiAobykge1xuXG4gICAgICAgIHJldHVybiBvLnJlcGxhY2UoL15cXHMqKD86KHZhclxcKFteKV0rXFwpKXw6P2dsb2JhbFxcKFxccyooW19BLVphLXpdWy1cXHddKilcXHMqXFwpfCgpKC0/W19BLVphLXpdWy1cXHddKikpLywgc3RhdGUubG9jYWxpemVSZXBsYWNlcilcblxuICAgICAgfSkuam9pbignLCcpXG4gICAgfVxuXG4gICAgaWYoaykgZW1pdC5kZWNsKGssIG8pXG4gICAgZWxzZSBlbWl0LnJhdyhvKVxuXG4gIH1cbn1cbiIsImltcG9ydCB7ZmxhdEl0ZXJ9IGZyb20gJy4vaGVscGVycydcbmltcG9ydCB7cnVsZXN9IGZyb20gJy4vcnVsZXMnXG5pbXBvcnQge2RlY2xhcmF0aW9uc30gZnJvbSAnLi9kZWNsYXJhdGlvbnMnXG5cbi8qKlxuICogSGFuZGxlcyBhIHNpbmdsZSBhdC1ydWxlc1xuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBzdGF0ZSAtIGhvbGRzIHRoZSBsb2NhbGl6ZXItIGFuZCB3YWxrZXItcmVsYXRlZCBtZXRob2RzXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICBhbmQgc3RhdGVcbiAqIEBwYXJhbSB7b2JqZWN0fSBlbWl0IC0gdGhlIGNvbnRleHR1YWwgZW1pdHRlcnMgdG8gdGhlIGZpbmFsIGJ1ZmZlclxuICogQHBhcmFtIHthcnJheX0gayAtIFRoZSBwYXJzZWQgYXQtcnVsZSwgaW5jbHVkaW5nIHRoZSBwYXJhbWV0ZXJzLFxuICogICAgICAgICAgICAgICAgICAgIGlmIHRha2VzIGJvdGggcGFyYW1ldGVycyBhbmQgYSBibG9jay5cbiAqICAgICAgICAgICAgICAgICAgICBrID09IFttYXRjaCwgZnVsbEF0UnVsZSwgYXRSdWxlVHlwZSwgcGFyYW1zP11cbiAqICAgICAgICAgICAgICAgICAgICBTbyBpbiBgQC13ZWJraXQta2V5ZnJhbWVzIGZvb2AsIHdlIGhhdmVcbiAqICAgICAgICAgICAgICAgICAgICAgLSBtYXRjaCA9IFwiQC13ZWJraXQta2V5ZnJhbWVzIGZvb1wiXG4gKiAgICAgICAgICAgICAgICAgICAgIC0gZnVsbEF0UnVsZSA9IFwiQC13ZWJraXQta2V5ZnJhbWVzXCJcbiAqICAgICAgICAgICAgICAgICAgICAgLSBhdFJ1bGVUeXBlID0gXCJrZXlmcmFtZXNcIlxuICogICAgICAgICAgICAgICAgICAgICAtIHBhcmFtcyA9IFwiZm9vXCJcbiAqIEBwYXJhbSB7c3RyaW5nfHN0cmluZ1tdfG9iamVjdHxvYmplY3RbXX0gdiAtIEVpdGhlciBwYXJhbWV0ZXJzIGZvclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2stbGVzcyBydWxlcyBvclxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlaXIgYmxvY2tcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0aGUgb3RoZXJzLlxuICogQHBhcmFtIHtzdHJpbmd9IHByZWZpeCAtIHRoZSBjdXJyZW50IHNlbGVjdG9yIG9yIHRoZSBzZWxlY3RvciBwcmVmaXhcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICBpbiBjYXNlIG9mIG5lc3RlZCBydWxlc1xuICogQHBhcmFtIHtib29sZWFufSBsb2NhbCAtIGFyZSB3ZSBpbiBAbG9jYWwgb3IgaW4gQGdsb2JhbCBzY29wZT9cbiAqIEBwYXJhbSB7c3RyaW5nfSBuZXN0aW5nRGVwdGggLSBhcmUgd2UgbmVzdGVkIGluIGFuIGF0LXJ1bGUgb3IgYSBzZWxlY3Rvcj9cbiAqL1xuXG5leHBvcnQgZnVuY3Rpb24gYXRSdWxlcyhzdGF0ZSwgZW1pdCwgaywgdiwgcHJlZml4LCBsb2NhbCwgbmVzdGluZ0RlcHRoKSB7XG5cbiAgLy8gRmlyc3QgaXRlcmF0ZSBvdmVyIHVzZXItcHJvdmlkZWQgYXQtcnVsZXMgYW5kIHJldHVybiBpZiBvbmUgb2YgdGhlbSBjb3JyZXNwb25kcyB0byB0aGUgY3VycmVudCBvbmVcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdGF0ZS5hdHJ1bGVIYW5kbGVycy5sZW5ndGg7IGkrKykge1xuXG4gICAgaWYgKHN0YXRlLmF0cnVsZUhhbmRsZXJzW2ldKHN0YXRlLCBlbWl0LCBrLCB2LCBwcmVmaXgsIGxvY2FsLCBuZXN0aW5nRGVwdGgpKSByZXR1cm5cblxuICB9XG5cbiAgLy8gdXNpbmcgYC9eZ2xvYmFsJC8udGVzdChrWzJdKWAgcmF0aGVyIHRoYXQgJ2dsb2JhbCcgPT0ga1syXSBnemlwc1xuICAvLyBzbGlnaHRseSBiZXR0ZXIgdGhhbmtzIHRvIHRoZSByZWdleHBzIHRlc3RzIGZ1cnRoZXIgZG93bi5cbiAgLy8gSXQgaXMgc2xpZ2h0bHkgbGVzcyBlZmZpY2llbnQgYnV0IHRoaXMgaXNuJ3QgYSBjcml0aWNhbCBwYXRoLlxuXG4gIGlmICgha1szXSAmJiAvXmdsb2JhbCQvLnRlc3Qoa1syXSkpIHtcblxuICAgIHJ1bGVzKHN0YXRlLCBlbWl0LCBwcmVmaXgsIHYsIDAsIG5lc3RpbmdEZXB0aClcblxuXG4gIH0gZWxzZSBpZiAoIWtbM10gJiYgL15sb2NhbCQvLnRlc3Qoa1syXSkpIHtcblxuICAgIHJ1bGVzKHN0YXRlLCBlbWl0LCBwcmVmaXgsIHYsIDEsIG5lc3RpbmdEZXB0aClcblxuXG4gIH0gZWxzZSBpZiAoa1szXSAmJiAvXmFkb3B0JC8udGVzdChrWzJdKSkge1xuXG4gICAgaWYgKCFsb2NhbCB8fCBuZXN0aW5nRGVwdGgpIHJldHVybiBlbWl0LmVycignQGFkb3B0IGdsb2JhbCBvciBuZXN0ZWQ6ICcgKyBrWzBdKVxuXG4gICAgaWYgKCEvXlxcLj9bX0EtWmEtel1bLVxcd10qJC8udGVzdChrWzNdKSkgcmV0dXJuIGVtaXQuZXJyKCdiYWQgYWRvcHRlciAnICsgSlNPTi5zdHJpbmdpZnkoa1szXSkgKyAnIGluICcgKyBrWzBdKVxuXG4gICAgaSA9IFtdXG4gICAgZmxhdEl0ZXIoZnVuY3Rpb24oYWRvcHRlZSwgYXNTdHJpbmcpIHtcblxuICAgICAgaWYoYWRvcHRlZSA9PSBudWxsIHx8ICEvXlxcLj9bX0EtWmEtel1bLVxcd10qKD86XFxzK1xcLj9bX0EtWmEtel1bLVxcd10qKSokLy50ZXN0KGFzU3RyaW5nID0gYWRvcHRlZSArICcnKSkgZW1pdC5lcnIoJ2JhZCBhZG9wdGVlICcrIEpTT04uc3RyaW5naWZ5KGFkb3B0ZWUpICsgJyBpbiAnICsga1swXSlcblxuICAgICAgZWxzZSBpLnB1c2goYXNTdHJpbmcucmVwbGFjZSgvXFwuL2csICcnKSlcblxuICAgIH0pKHYpXG5cbiAgICAvLyB3ZSBtYXkgZW5kIHVwIHdpdGggZHVwbGljYXRlIGNsYXNzZXMgYnV0IEFGQUlLIGl0IGhhcyBubyBjb25zZXF1ZW5jZXMgb24gc3BlY2lmaWNpdHkuXG4gICAgaWYgKGkubGVuZ3RoKSB7XG4gICAgICBzdGF0ZS5sb2NhbGl6ZShrWzNdID0ga1szXS5yZXBsYWNlKC9cXC4vZywgJycpKVxuICAgICAgc3RhdGUubmFtZXNba1szXV0gKz0gKCcgJyArIGkuam9pbignICcpKVxuICAgIH1cblxuXG4gIH0gZWxzZSBpZiAoIWtbM10gJiYgL14oPzpuYW1lc3BhY2V8aW1wb3J0fGNoYXJzZXQpJC8udGVzdChrWzJdKSkge1xuICAgIGZsYXRJdGVyKGZ1bmN0aW9uKHYpIHtcblxuICAgICAgZW1pdC5hdHJ1bGUoa1sxXSwga1syXSwgdilcblxuICAgIH0pKHYpXG5cblxuICB9IGVsc2UgaWYgKCFrWzNdICYmIC9eKD86Zm9udC1mYWNlfHZpZXdwb3J0KSQvLnRlc3Qoa1syXSkpIHtcbiAgICBmbGF0SXRlcihmdW5jdGlvbih2KSB7XG5cbiAgICAgIGVtaXQuYXRydWxlKGtbMV0sIGtbMl0sIGtbM10sICdkZWNsJylcblxuICAgICAgZGVjbGFyYXRpb25zKHN0YXRlLCBlbWl0LCAnJywgdiwgbG9jYWwpXG5cbiAgICAgIGVtaXQuX2F0cnVsZSgpXG5cbiAgICB9KSh2KVxuXG4gIH0gZWxzZSBpZiAoa1szXSAmJiAvXig/Om1lZGlhfHN1cHBvcnRzfHBhZ2V8a2V5ZnJhbWVzKSQvLnRlc3Qoa1syXSkpIHtcblxuICAgIGlmIChsb2NhbCAmJiAna2V5ZnJhbWVzJyA9PSBrWzJdKSB7XG4gICAgICBrWzNdID0ga1szXS5yZXBsYWNlKFxuICAgICAgICAvLyBnZW5lcmF0ZWQgYnkgc2NyaXB0L3JlZ2V4cHMuanNcbiAgICAgICAgLyh2YXJcXChbXildK1xcKSl8Oj9nbG9iYWxcXChcXHMqKFtfQS1aYS16XVstXFx3XSopXFxzKlxcKXwoKSgtP1tfQS1aYS16XVstXFx3XSopLyxcbiAgICAgICAgc3RhdGUubG9jYWxpemVSZXBsYWNlclxuICAgICAgKVxuICAgIH1cblxuICAgIGlmICgncGFnZScgPT0ga1syXSkge1xuXG4gICAgICBlbWl0LmF0cnVsZShrWzFdLCBrWzJdLCBrWzNdLCAnZGVjbCcpXG5cbiAgICAgIGRlY2xhcmF0aW9ucyhzdGF0ZSwgZW1pdCwgJycsIHYsIGxvY2FsKVxuXG4gICAgfSBlbHNlIHtcblxuICAgICAgZW1pdC5hdHJ1bGUoa1sxXSwga1syXSwga1szXSwgJ3J1bGUnKVxuXG4gICAgICBydWxlcyhcbiAgICAgICAgc3RhdGUsIGVtaXQsXG4gICAgICAgICdrZXlmcmFtZXMnID09IGtbMl0gPyAnJyA6IHByZWZpeCxcbiAgICAgICAgdiwgbG9jYWwsIG5lc3RpbmdEZXB0aCArIDFcbiAgICAgIClcblxuICAgIH1cblxuICAgIGVtaXQuX2F0cnVsZSgpXG5cbiAgfSBlbHNlIHtcblxuICAgIGVtaXQuZXJyKCdVbnN1cHBvcnRlZCBhdC1ydWxlOiAnICsga1swXSlcblxuICB9XG59XG4iLCJpbXBvcnQge3R5cGUsIEFSUkFZLCBPQkpFQ1QsIFNUUklORywgYW1wZXJzYW5kLCBvd24sIHNwbGl0U2VsZWN0b3J9IGZyb20gJy4vaGVscGVycydcbmltcG9ydCB7ZGVjbGFyYXRpb25zfSBmcm9tICcuL2RlY2xhcmF0aW9ucydcbmltcG9ydCB7YXRSdWxlc30gZnJvbSAnLi9hdC1ydWxlcydcblxuLyoqXG4gKiBBZGQgcnVsZXNldHMgYW5kIG90aGVyIENTUyB0cmVlIHRvIHRoZSBzaGVldC5cbiAqXG4gKiBAcGFyYW0ge29iamVjdH0gc3RhdGUgLSBob2xkcyB0aGUgbG9jYWxpemVyLSBhbmQgd2Fsa2VyLXJlbGF0ZWQgbWV0aG9kc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgYW5kIHN0YXRlXG4gKiBAcGFyYW0ge29iamVjdH0gZW1pdCAtIHRoZSBjb250ZXh0dWFsIGVtaXR0ZXJzIHRvIHRoZSBmaW5hbCBidWZmZXJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwcmVmaXggLSB0aGUgY3VycmVudCBzZWxlY3RvciBvciBhIHByZWZpeCBpbiBjYXNlIG9mIG5lc3RlZCBydWxlc1xuICogQHBhcmFtIHthcnJheXxzdHJpbmd8b2JqZWN0fSB0cmVlIC0gYSBzb3VyY2Ugb2JqZWN0IG9yIHN1Yi1vYmplY3QuXG4gKiBAcGFyYW0ge3N0cmluZ30gbmVzdGluZ0RlcHRoIC0gYXJlIHdlIG5lc3RlZCBpbiBhbiBhdC1ydWxlP1xuICogQHBhcmFtIHtib29sZWFufSBsb2NhbCAtIGFyZSB3ZSBpbiBAbG9jYWwgb3IgaW4gQGdsb2JhbCBzY29wZT9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJ1bGVzKHN0YXRlLCBlbWl0LCBwcmVmaXgsIHRyZWUsIGxvY2FsLCBuZXN0aW5nRGVwdGgpIHtcbiAgdmFyIGssIHYsIGluRGVjbGFyYXRpb24sIGtrXG5cbiAgc3dpdGNoICh0eXBlLmNhbGwodHJlZSkpIHtcblxuICBjYXNlIE9CSkVDVDpcbiAgICBmb3IgKGsgaW4gdHJlZSkgaWYgKG93bi5jYWxsKHRyZWUsIGspKSB7XG4gICAgICB2ID0gdHJlZVtrXVxuXG4gICAgICBpZiAocHJlZml4Lmxlbmd0aCA+IDAgJiYgL15bLVxcdyRdKyQvLnRlc3QoaykpIHtcbiAgICAgICAgaWYgKCFpbkRlY2xhcmF0aW9uKSB7XG4gICAgICAgICAgaW5EZWNsYXJhdGlvbiA9IDFcblxuICAgICAgICAgIGVtaXQucnVsZShwcmVmaXgpXG5cbiAgICAgICAgfVxuICAgICAgICBpZiAoL1xcJC8udGVzdChrKSkge1xuICAgICAgICAgIGZvciAoa2sgaW4gKGsgPSBrLnNwbGl0KCckJykpKSBpZiAob3duLmNhbGwoaywga2spKSB7XG5cbiAgICAgICAgICAgIGRlY2xhcmF0aW9ucyhzdGF0ZSwgZW1pdCwga1tra10sIHYsIGxvY2FsKVxuXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgZGVjbGFyYXRpb25zKHN0YXRlLCBlbWl0LCBrLCB2LCBsb2NhbClcblxuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSBpZiAoL15ALy50ZXN0KGspKSB7XG4gICAgICAgIC8vIEhhbmRsZSBBdC1ydWxlc1xuICAgICAgICBpbkRlY2xhcmF0aW9uID0gMFxuXG4gICAgICAgIGF0UnVsZXMoc3RhdGUsIGVtaXQsXG4gICAgICAgICAgL14oLig/Oi1bXFx3XSstKT8oW19BLVphLXpdWy1cXHddKikpXFxiXFxzKiguKj8pXFxzKiQvLmV4ZWMoaykgfHwgW2ssJ0AnLCcnLCcnXSxcbiAgICAgICAgICB2LCBwcmVmaXgsIGxvY2FsLCBuZXN0aW5nRGVwdGhcbiAgICAgICAgKVxuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBzZWxlY3RvciBvciBuZXN0ZWQgc3ViLXNlbGVjdG9yc1xuICAgICAgICBpbkRlY2xhcmF0aW9uID0gMFxuXG4gICAgICAgIHJ1bGVzKFxuICAgICAgICAgIHN0YXRlLCBlbWl0LFxuICAgICAgICAgIC8vIGJ1aWxkIHRoZSBzZWxlY3RvciBgcHJlZml4YCBmb3IgdGhlIG5leHQgaXRlcmF0aW9uLlxuICAgICAgICAgIC8vIHVnbHkgYW5kIGZ1bGwgb2YgcmVkdW5kYW50IGJpdHMgYnV0IHNvIGZhciB0aGUgZmFzdGVzdC9zaG9ydGVzdC5nelxuICAgICAgICAgIC8qMCBpZiovKHByZWZpeC5sZW5ndGggPiAwICYmICgvLC8udGVzdChwcmVmaXgpIHx8IC8sLy50ZXN0KGspKSkgP1xuXG4gICAgICAgICAgICAvKjAgdGhlbiovIChrayA9IHNwbGl0U2VsZWN0b3IocHJlZml4KSwgc3BsaXRTZWxlY3RvcihcbiAgICAgICAgICAgICAgbG9jYWwgP1xuXG4gICAgICAgICAgICAgICAgay5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgLyhcIig/OlxcXFwufFteXCJcXG5dKSpcInwnKD86XFxcXC58W14nXFxuXSkqJ3xcXC9cXCpbXFxzXFxTXSo/XFwqXFwvKXw6Z2xvYmFsXFwoXFxzKihcXC4tP1tfQS1aYS16XVstXFx3XSopXFxzKlxcKXwoXFwuKSgtP1tfQS1aYS16XVstXFx3XSopL2csXG4gICAgICAgICAgICAgICAgICBzdGF0ZS5sb2NhbGl6ZVJlcGxhY2VyXG4gICAgICAgICAgICAgICAgKSA6XG5cbiAgICAgICAgICAgICAgICBrXG4gICAgICAgICAgICApLm1hcChmdW5jdGlvbiAoaykge1xuICAgICAgICAgICAgICByZXR1cm4gLyYvLnRlc3QoaykgPyBhbXBlcnNhbmQoaywga2spIDoga2subWFwKGZ1bmN0aW9uKGtrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtrICsga1xuICAgICAgICAgICAgICB9KS5qb2luKCcsJylcbiAgICAgICAgICAgIH0pLmpvaW4oJywnKSkgOlxuXG4gICAgICAgICAgICAvKjAgZWxzZSovIC8qMSBpZiovIC8mLy50ZXN0KGspID9cblxuICAgICAgICAgICAgICAvKjEgdGhlbiovIGFtcGVyc2FuZChcbiAgICAgICAgICAgICAgICBsb2NhbCA/XG5cbiAgICAgICAgICAgICAgICAgIGsucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgLyhcIig/OlxcXFwufFteXCJcXG5dKSpcInwnKD86XFxcXC58W14nXFxuXSkqJ3xcXC9cXCpbXFxzXFxTXSo/XFwqXFwvKXw6Z2xvYmFsXFwoXFxzKihcXC4tP1tfQS1aYS16XVstXFx3XSopXFxzKlxcKXwoXFwuKSgtP1tfQS1aYS16XVstXFx3XSopL2csXG4gICAgICAgICAgICAgICAgICAgIHN0YXRlLmxvY2FsaXplUmVwbGFjZXJcbiAgICAgICAgICAgICAgICAgICkgOlxuXG4gICAgICAgICAgICAgICAgICBrLFxuICAgICAgICAgICAgICAgIFtwcmVmaXhdXG4gICAgICAgICAgICAgICkgOlxuXG4gICAgICAgICAgICAgIC8qMSBlbHNlKi8gcHJlZml4ICsgKFxuICAgICAgICAgICAgICAgIGxvY2FsID9cblxuICAgICAgICAgICAgICAgICAgay5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAvKFwiKD86XFxcXC58W15cIlxcbl0pKlwifCcoPzpcXFxcLnxbXidcXG5dKSonfFxcL1xcKltcXHNcXFNdKj9cXCpcXC8pfDpnbG9iYWxcXChcXHMqKFxcLi0/W19BLVphLXpdWy1cXHddKilcXHMqXFwpfChcXC4pKC0/W19BLVphLXpdWy1cXHddKikvZyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUubG9jYWxpemVSZXBsYWNlclxuICAgICAgICAgICAgICAgICAgKSA6XG5cbiAgICAgICAgICAgICAgICAgIGtcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICB2LCBsb2NhbCwgbmVzdGluZ0RlcHRoICsgMVxuICAgICAgICApXG5cbiAgICAgIH1cbiAgICB9XG5cbiAgICBicmVha1xuXG4gIGNhc2UgQVJSQVk6XG4gICAgZm9yIChrID0gMDsgayA8IHRyZWUubGVuZ3RoOyBrKyspe1xuXG4gICAgICBydWxlcyhzdGF0ZSwgZW1pdCwgcHJlZml4LCB0cmVlW2tdLCBsb2NhbCwgbmVzdGluZ0RlcHRoKVxuXG4gICAgfVxuICAgIGJyZWFrXG5cbiAgY2FzZSBTVFJJTkc6XG4gICAgLy8gQ1NTIGhhY2tzIG9yIG91cHR1dCBvZiBgajJjLmlubGluZWAuXG5cbiAgICBpZiAocHJlZml4Lmxlbmd0aCkgZW1pdC5ydWxlKHByZWZpeClcblxuICAgIGVtaXQucmF3KHRyZWUpXG5cbiAgfVxufVxuXG4vLyBUaGlzIGlzIHRoZSBmaXJzdCBlbnRyeSBpbiB0aGUgZmlsdGVycyBhcnJheSwgd2hpY2ggaXNcbi8vIGFjdHVhbGx5IHRoZSBsYXN0IHN0ZXAgb2YgdGhlIGNvbXBpbGVyLiBJdCBpbnNlcnRzXG4vLyBjbG9zaW5nIGJyYWNlcyB0byBjbG9zZSBub3JtYWwgKG5vbiBhdC0pIHJ1bGVzICh0aG9zZVxuLy8gdGhhdCBzdGFydCB3aXRoIGEgc2VsZWN0b3IpLiBEb2luZyBpdCBlYXJsaWVyIGlzXG4vLyBpbXBvc3NpYmxlIHdpdGhvdXQgcGFzc2luZyBzdGF0ZSBhcm91bmQgaW4gdW5yZWxhdGVkIGNvZGVcbi8vIG9yIGVuZGluZyB1cCB3aXRoIGR1cGxpY2F0ZWQgc2VsZWN0b3JzIHdoZW4gdGhlIHNvdXJjZSB0cmVlXG4vLyBjb250YWlucyBhcnJheXMuXG4vLyBUaGVyZSdzIG5vIGBfcnVsZWAgaGFuZGxlciwgYmVjYXVzZSB0aGUgY29yZSBjb21waWxlciBuZXZlclxuLy8gY2FsbHMgaXQuXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VTZWxlY3RvcnMobmV4dCwgaW5saW5lKSB7XG4gIHZhciBsYXN0U2VsZWN0b3JcbiAgcmV0dXJuIGlubGluZSA/IG5leHQgOiB7XG4gICAgaW5pdDogZnVuY3Rpb24oKXtsYXN0U2VsZWN0b3IgPSAwOyBuZXh0LmluaXQoKX0sXG4gICAgZG9uZTogZnVuY3Rpb24gKHJhdykge1xuICAgICAgaWYgKGxhc3RTZWxlY3Rvcikge25leHQuX3J1bGUoKTsgbGFzdFNlbGVjdG9yID0gMH1cbiAgICAgIHJldHVybiBuZXh0LmRvbmUocmF3KVxuICAgIH0sXG4gICAgYXRydWxlOiBmdW5jdGlvbiAocnVsZSwga2luZCwgcGFyYW0sIHRha2VzQmxvY2spIHtcbiAgICAgIGlmIChsYXN0U2VsZWN0b3IpIHtuZXh0Ll9ydWxlKCk7IGxhc3RTZWxlY3RvciA9IDB9XG4gICAgICBuZXh0LmF0cnVsZShydWxlLCBraW5kLCBwYXJhbSwgdGFrZXNCbG9jaylcbiAgICB9LFxuICAgIF9hdHJ1bGU6IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICBpZiAobGFzdFNlbGVjdG9yKSB7bmV4dC5fcnVsZSgpOyBsYXN0U2VsZWN0b3IgPSAwfVxuICAgICAgbmV4dC5fYXRydWxlKHJ1bGUpXG4gICAgfSxcbiAgICBydWxlOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHtcbiAgICAgIGlmIChzZWxlY3RvciAhPT0gbGFzdFNlbGVjdG9yKXtcbiAgICAgICAgaWYgKGxhc3RTZWxlY3RvcikgbmV4dC5fcnVsZSgpXG4gICAgICAgIG5leHQucnVsZShzZWxlY3RvcilcbiAgICAgICAgbGFzdFNlbGVjdG9yID0gc2VsZWN0b3JcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBnbG9iYWwoeCkge1xuICByZXR1cm4gJzpnbG9iYWwoJyArIHggKyAnKSdcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGt2IChrLCB2LCBvKSB7XG4gIG8gPSB7fVxuICBvW2tdID0gdlxuICByZXR1cm4gb1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXQgKHJ1bGUsIHBhcmFtcywgYmxvY2spIHtcbiAgaWYgKFxuICAgIGFyZ3VtZW50cy5sZW5ndGggPCAzXG4gICkge1xuICAgIC8vIGlubmVyIGN1cnJ5IVxuICAgIHZhciBfYXQgPSBhdC5iaW5kLmFwcGx5KGF0LCBbbnVsbF0uY29uY2F0KFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLDApKSlcbiAgICAvLyBTbyB0aGF0IGl0IGNhbiBiZSB1c2VkIGFzIGEga2V5IGluIGFuIEVTNiBvYmplY3QgbGl0ZXJhbC5cbiAgICBfYXQudG9TdHJpbmcgPSBmdW5jdGlvbigpe3JldHVybiAnQCcgKyBydWxlICsgJyAnICsgcGFyYW1zfVxuICAgIHJldHVybiBfYXRcbiAgfVxuICBlbHNlIHJldHVybiBrdignQCcgKyBydWxlICsnICcgKyBwYXJhbXMsIGJsb2NrKVxufSIsImltcG9ydCB7ZGVmYXVsdHMsIGZsYXRJdGVyLCBmcmVlemUsIHJhbmRDaGFycywgdHlwZSwgQVJSQVksIEZVTkNUSU9OLCBOVU1CRVIsIE9CSkVDVCwgU1RSSU5HfSBmcm9tICcuL2hlbHBlcnMnXG5pbXBvcnQge2Nsb3NlU2VsZWN0b3JzLCBydWxlc30gZnJvbSAnLi9ydWxlcydcbmltcG9ydCB7ZGVjbGFyYXRpb25zfSBmcm9tICcuL2RlY2xhcmF0aW9ucydcbmltcG9ydCB7YXRSdWxlc30gZnJvbSAnLi9hdC1ydWxlcydcbmltcG9ydCB7YXQsIGdsb2JhbCwga3Z9IGZyb20gJy4vZXh0cmFzJ1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBKMmMob3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICAvLyB0aGUgYnVmZmVyIHRoYXQgYWNjdW11bGF0ZXMgdGhlIG91dHB1dC4gSW5pdGlhbGl6ZWQgaW4gYCRzaW5rLmluaXQoKWBcbiAgdmFyIGJ1ZiwgZXJyXG5cbiAgLy8gdGhlIGRlZmF1bHQgc2luay5cbiAgdmFyIF9iYWNrZW5kID0gW3tcbiAgICBpbml0OiBmdW5jdGlvbigpe2J1Zj1bXSwgZXJyPVtdfSxcbiAgICBkb25lOiBmdW5jdGlvbiAocmF3KSB7XG4gICAgICBpZiAoZXJyLmxlbmd0aCAhPSAwKSB0aHJvdyBuZXcgRXJyb3IoJ2oyYyBlcnJvcihzKTogJyArIEpTT04uc3RyaW5naWZ5KGVycixudWxsLDIpICsgJ2luIGNvbnRleHQ6XFxuJyArIGJ1Zi5qb2luKCcnKSlcbiAgICAgIHJldHVybiByYXcgPyBidWYgOiBidWYuam9pbignJylcbiAgICB9LFxuICAgIGVycjogZnVuY3Rpb24obXNnKSB7XG4gICAgICBlcnIucHVzaChtc2cpXG4gICAgICBidWYucHVzaCgnLyogKysrIEVSUk9SICsrKyAnICsgbXNnICsgJyAqL1xcbicpXG4gICAgfSxcbiAgICByYXc6IGZ1bmN0aW9uKHN0cikge2J1Zi5wdXNoKHN0ciwgX2luc3RhbmNlLmVuZGxpbmUpfSxcbiAgICBhdHJ1bGU6IGZ1bmN0aW9uIChydWxlLCBraW5kLCBwYXJhbSwgdGFrZXNCbG9jaykge1xuICAgICAgYnVmLnB1c2gocnVsZSwgcGFyYW0gJiYgJyAnLCBwYXJhbSwgdGFrZXNCbG9jayA/ICcgeycgOiAnOycsIF9pbnN0YW5jZS5lbmRsaW5lKVxuICAgIH0sXG4gICAgLy8gY2xvc2UgYXRydWxlXG4gICAgX2F0cnVsZTogZnVuY3Rpb24gKCkge2J1Zi5wdXNoKCd9JywgX2luc3RhbmNlLmVuZGxpbmUpfSxcbiAgICBydWxlOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHtidWYucHVzaChzZWxlY3RvciwgJyB7JywgX2luc3RhbmNlLmVuZGxpbmUpfSxcbiAgICAvLyBjbG9zZSBydWxlXG4gICAgX3J1bGU6IGZ1bmN0aW9uICgpIHtidWYucHVzaCgnfScsIF9pbnN0YW5jZS5lbmRsaW5lKX0sXG4gICAgZGVjbDogZnVuY3Rpb24gKHByb3AsIHZhbHVlKSB7YnVmLnB1c2gocHJvcCwgJzonLCB2YWx1ZSwgJzsnLCBfaW5zdGFuY2UuZW5kbGluZSl9XG4gIH1dXG5cbiAgLy8gaG9sZHMgdGhlIGBfZmlsdGVyYCBhbmQgYGF0cnVsZWAgaGFuZGxlcnNcbiAgdmFyIF9maWx0ZXJzID0gW2Nsb3NlU2VsZWN0b3JzXVxuICB2YXIgX2F0cnVsZUhhbmRsZXJzID0gW11cblxuICAvLyB0aGUgcHVibGljIEFQSSAoc2VlIHRoZSBtYWluIGRvY3MpXG4gIHZhciBfaW5zdGFuY2UgPSB7XG4gICAgYXQ6IGF0LFxuICAgIGdsb2JhbDogZ2xvYmFsLFxuICAgIGt2OiBrdixcbiAgICBuYW1lczoge30sXG4gICAgZW5kbGluZTogJ1xcbicsXG4gICAgc3VmZml4OiByYW5kQ2hhcnMoNyksXG4gICAgcGx1Z2luczogW10sXG4gICAgc2hlZXQ6IGZ1bmN0aW9uKHRyZWUpIHtcbiAgICAgIF9iYWNrZW5kWzBdLmluaXQoKVxuICAgICAgcnVsZXMoXG4gICAgICAgIF93YWxrZXJzWzBdLFxuICAgICAgICBfYmFja2VuZFswXSxcbiAgICAgICAgJycsIC8vIHByZWZpeFxuICAgICAgICB0cmVlLFxuICAgICAgICAxLCAgLy8gbG9jYWwsIGJ5IGRlZmF1bHRcbiAgICAgICAgMCAgIC8vIG5lc3RpbmcgZGVwdGhcbiAgICAgIClcblxuICAgICAgcmV0dXJuIF9iYWNrZW5kWzBdLmRvbmUoKVxuICAgIH0sXG4gICAgaW5saW5lOiBmdW5jdGlvbiAodHJlZSwgb3B0aW9ucykge1xuICAgICAgX2JhY2tlbmRbMV0uaW5pdCgpXG4gICAgICBkZWNsYXJhdGlvbnMoXG4gICAgICAgIF93YWxrZXJzWzFdLFxuICAgICAgICBfYmFja2VuZFsxXSxcbiAgICAgICAgJycsIC8vIHByZWZpeFxuICAgICAgICB0cmVlLFxuICAgICAgICAhKG9wdGlvbnMgJiYgb3B0aW9ucy5nbG9iYWwpICAgLy8gbG9jYWwsIGJ5IGRlZmF1bHRcbiAgICAgIClcbiAgICAgIHJldHVybiBfYmFja2VuZFsxXS5kb25lKClcbiAgICB9XG4gIH1cblxuICAvLyBUaGUgYHN0YXRlYCAoZm9yIHRoZSBjb3JlIGZ1bmN0aW9ucykgLyBgd2Fsa2VyYCAoZm9yIHRoZSBwbHVnaW5zKSB0YWJsZXMuXG4gIHZhciBfd2Fsa2VycyA9IFtcbiAgICAvLyBmb3IgajJjLnNoZWV0XG4gICAge1xuICAgICAgLy8gaGVscGVycyBmb3IgbG9jYWl6aW5nIGNsYXNzIGFuZCBhbmltYXRpb24gbmFtZXNcbiAgICAgIGxvY2FsaXplUmVwbGFjZXI6IF9sb2NhbGl6ZVJlcGxhY2VyLCAvLyBzZWNvbmQgYXJndW1lbnQgdG8gU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlXG4gICAgICBsb2NhbGl6ZTogX2xvY2FsaXplLCAgICAgICAgICAgICAgICAgLy8gbWFuZ2xlcyBsb2NhbCBuYW1lc1xuICAgICAgbmFtZXM6IF9pbnN0YW5jZS5uYW1lcywgICAgICAgICAgICAgIC8vIGxvY2FsID0+IG1hbmdsZWQgbWFwcGluZ1xuICAgICAgYXRydWxlSGFuZGxlcnM6IF9hdHJ1bGVIYW5kbGVycywgICAgICAgICAgICAvLyBleHRyYSBhdC1ydWxlc1xuICAgICAgLy8gVGhlIGNvcmUgd2Fsa2VyIG1ldGhvZHMsIHRvIGJlIHByb3ZpZGVkIHRvIHBsdWdpbnNcbiAgICAgIGF0cnVsZTogYXRSdWxlcyxcbiAgICAgIGRlY2w6IGRlY2xhcmF0aW9ucyxcbiAgICAgIHJ1bGU6IHJ1bGVzXG4gICAgfSxcbiAgICAvLyBsaWtld2lzZSwgZm9yIGoyYy5pbmxpbmUgKGlkZW0gd2l0aCBgJGFgLCBgYWAgYW5kIGBzYCByZW1vdmVkKVxuICAgIHtcbiAgICAgIGxvY2FsaXplUmVwbGFjZXI6IF9sb2NhbGl6ZVJlcGxhY2VyLFxuICAgICAgbG9jYWxpemU6IF9sb2NhbGl6ZSxcbiAgICAgIG5hbWVzOiBfaW5zdGFuY2UubmFtZXMsXG4gICAgICBkZWNsOiBkZWNsYXJhdGlvbnNcbiAgICB9XG4gIF1cblxuICAvKipcbiAgICogUmV0dXJucyBhIGxvY2FsaXplZCB2ZXJzaW9uIG9mIGEgZ2l2ZW4gbmFtZS5cbiAgICogUmVnaXN0ZXJzIHRoZSBwYWlyIGluIGBpbnN0bmFjZS5uYW1lYCBpZiBuZWVkZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gdGhlIG5hbWUgdG8gbG9jYWxpemVcbiAgICogQHJldHVybiB7c3RyaW5nfSAtIHRoZSBsb2NhbGl6ZWQgdmVyc2lvblxuICAgKi9cbiAgZnVuY3Rpb24gX2xvY2FsaXplKG5hbWUpIHtcbiAgICBpZiAoIV9pbnN0YW5jZS5uYW1lc1tuYW1lXSkgX2luc3RhbmNlLm5hbWVzW25hbWVdID0gbmFtZSArIF9pbnN0YW5jZS5zdWZmaXhcbiAgICByZXR1cm4gX2luc3RhbmNlLm5hbWVzW25hbWVdLm1hdGNoKC9eXFxTKy8pXG4gIH1cblxuICAvKipcbiAgICogVXNlZCBhcyBzZWNvbmQgYXJndW1lbnQgZm9yIHN0ci5yZXBsYWNlKGxvY2FsaXplUmVnZXgsIHJlcGxhY2VyKVxuICAgKiBgaWdub3JlYCwgYGdsb2JhbGAgYW5kIGAoZG90LCBuYW1lKWAgYXJlIG11dHVhbGx5IGV4Y2x1c2l2ZVxuICAgKlxuICAgKiBAcGFyYW0ge3N0cmluZ30gbWF0Y2ggLSB0aGUgd2hvbGUgbWF0Y2ggKGlnbm9yZWQpXG4gICAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IGlnbm9yZSAtIGEgY29tbWVudCBvciBhIHN0cmluZyBsaXRlcmFsXG4gICAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IGdsb2JhbCAtIGEgZ2xvYmFsIG5hbWVcbiAgICogQHBhcmFtIHtzdHJpbmd8bnVsbH0gZG90IC0gZWl0aGVyICcuJyBmb3IgYSBsb2NhbCBjbGFzcyBuYW1lIG9yIHRoZSBlbXB0eSBzdHJpbmcgb3RoZXJ3aXNlXG4gICAqIEBwYXJhbSB7c3RyaW5nfG51bGx9IG5hbWUgLSB0aGUgbmFtZSB0byBsb2NhbGl6ZVxuICAgKiBAcmV0dXJuIHtzdHJpbmd9XG4gICAqL1xuICBmdW5jdGlvbiBfbG9jYWxpemVSZXBsYWNlcihtYXRjaCwgaWdub3JlLCBnbG9iYWwsIGRvdCwgbmFtZSkge1xuICAgIHJldHVybiBpZ25vcmUgfHwgZ2xvYmFsIHx8IGRvdCArIF9sb2NhbGl6ZShuYW1lKVxuICB9XG5cbiAgLy8gaGFuZGxlciBvcHRpb25zXG4gIGlmICh0eXBlLmNhbGwob3B0aW9ucy5wbHVnaW5zKSA9PT0gQVJSQVkpIHtcbiAgICBmbGF0SXRlcihmdW5jdGlvbihwbHVnaW4pIHtcbiAgICAgIF9pbnN0YW5jZS5wbHVnaW5zLnB1c2gocGx1Z2luKVxuICAgICAgaWYgKHR5cGUuY2FsbChwbHVnaW4pID09PSBGVU5DVElPTikgcGx1Z2luID0gcGx1Z2luKF9pbnN0YW5jZSlcbiAgICAgIGlmICghcGx1Z2luKSByZXR1cm5cblxuICAgICAgaWYgKHR5cGUuY2FsbChwbHVnaW4uZmlsdGVyKSA9PT0gRlVOQ1RJT04pIF9maWx0ZXJzLnB1c2gocGx1Z2luLmZpbHRlcilcbiAgICAgIGlmICh0eXBlLmNhbGwocGx1Z2luLmF0cnVsZSkgPT09IEZVTkNUSU9OKSBfYXRydWxlSGFuZGxlcnMucHVzaChwbHVnaW4uYXRydWxlKVxuICAgICAgaWYgKHR5cGUuY2FsbChwbHVnaW4uc2luaykgPT09IEZVTkNUSU9OKSBfYmFja2VuZCA9IHBsdWdpbi5zaW5rKClcbiAgICB9KShvcHRpb25zLnBsdWdpbnMpXG4gIH1cbiAgaWYgKHR5cGUuY2FsbChvcHRpb25zLm5hbWVzKSA9PT0gT0JKRUNUKSBfaW5zdGFuY2UubmFtZXMgPSBvcHRpb25zLm5hbWVzXG4gIGlmICh0eXBlLmNhbGwob3B0aW9ucy5zdWZmaXgpID09PSBTVFJJTkcpIF9pbnN0YW5jZS5zdWZmaXggPSBvcHRpb25zLnN1ZmZpeFxuICBpZiAodHlwZS5jYWxsKG9wdGlvbnMuc3VmZml4KSA9PT0gTlVNQkVSKSBfaW5zdGFuY2Uuc3VmZml4ID0gcmFuZENoYXJzKG9wdGlvbnMuc3VmZml4KVxuICBpZiAodHlwZS5jYWxsKG9wdGlvbnMuZW5kbGluZSkgPT09IFNUUklORykgX2luc3RhbmNlLmVuZGxpbmUgPSBvcHRpb25zLmVuZGluZVxuXG4gIF9iYWNrZW5kWzFdID0gX2JhY2tlbmRbMV0gfHwge1xuICAgIGluaXQ6IF9iYWNrZW5kWzBdLmluaXQsXG4gICAgZG9uZTogX2JhY2tlbmRbMF0uZG9uZSxcbiAgICByYXc6IF9iYWNrZW5kWzBdLnJhdyxcbiAgICBlcnI6IF9iYWNrZW5kWzBdLmVycixcbiAgICBkZWNsOiBfYmFja2VuZFswXS5kZWNsXG4gIH1cblxuICAvLyBmaW5hbGl6ZSB0aGUgYmFja2VuZCBieSBtZXJnaW5nIGluIHRoZSBmaWx0ZXJzXG4gIGZvcih2YXIgaSA9IDA7IGkgPCAyOyBpKyspeyAvLyAwIGZvciBqMmMuc2hlZXQsIDEgZm9yIGoyYy5pbmxpbmVcbiAgICBmb3IgKHZhciBqID0gX2ZpbHRlcnMubGVuZ3RoOyBqLS07KSB7XG4gICAgICBfYmFja2VuZFtpXSA9IGZyZWV6ZShcbiAgICAgICAgZGVmYXVsdHMoXG4gICAgICAgICAgX2ZpbHRlcnNbal0oX2JhY2tlbmRbaV0sICEhaSksXG4gICAgICAgICAgX2JhY2tlbmRbaV1cbiAgICAgICAgKVxuICAgICAgKVxuICAgIH1cbiAgfVxuXG4gIGZyZWV6ZShfaW5zdGFuY2UpXG4gIHJldHVybiBfaW5zdGFuY2Vcbn1cbiJdLCJuYW1lcyI6WyJnbG9iYWwiXSwi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TSxDQUFDLENBQUE7TUFDdkUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxRQUFRLEVBQUUsZUFBZSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUE7TUFDOUUsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxRQUFRLEVBQUUsUUFBUSxHQUFHLE1BQU0sQ0FBQyxJQUFJLEVBQUUsQ0FBQTtLQUNsRSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0dBQ3BCO0VBQ0QsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsS0FBSyxNQUFNLEVBQUUsU0FBUyxDQUFDLEtBQUssR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFBO0VBQ3hFLElBQUksSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssTUFBTSxFQUFFLFNBQVMsQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQTtFQUMzRSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLE1BQU0sRUFBRSxTQUFTLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUE7RUFDdEYsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxNQUFNLEVBQUUsU0FBUyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFBOztFQUU3RSxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxJQUFJO0lBQzNCLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSTtJQUN0QixJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUk7SUFDdEIsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHO0lBQ3BCLEdBQUcsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRztJQUNwQixJQUFJLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUk7R0FDdkIsQ0FBQTs7O0VBR0QsSUFBSSxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztJQUN4QixLQUFLLElBQUksQ0FBQyxHQUFHLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEdBQUc7TUFDbEMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU07UUFDbEIsUUFBUTtVQUNOLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztVQUM3QixRQUFRLENBQUMsQ0FBQyxDQUFDO1NBQ1o7T0FDRixDQUFBO0tBQ0Y7R0FDRjs7RUFFRCxNQUFNLENBQUMsU0FBUyxDQUFDLENBQUE7RUFDakIsT0FBTyxTQUFTO0NBQ2pCLDs7In0=